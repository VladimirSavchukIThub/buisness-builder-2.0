{% extends "base.html" %}

{% block title %}Результаты расчета - Бизнес Конструктор{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/result.css') }}">
{% endblock %}

{% block content %}
<div class="result-container" data-aos="fade-up">
    <div class="row">
        <div class="col-lg-10 mx-auto">
            <div class="card result-card shadow-lg">
                <div class="card-header bg-success text-white p-4">
                    <h2 class="mb-0"><i class="fas fa-check-circle me-2"></i>Ваш бизнес-план готов!</h2>
                </div>
                <div class="card-body p-4">
                    <div class="alert alert-success mb-4" role="alert">
                        <i class="fas fa-info-circle me-2"></i> Ваш бизнес-план был успешно рассчитан. Ниже представлены детали вашего проекта.
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <h3 class="mb-4">Детали бизнес-проекта</h3>
                            
                            <div class="details-container">
                                <div class="detail-item">
                                    <div class="detail-icon">
                                        <i class="fas fa-store"></i>
                                    </div>
                                    <div class="detail-content">
                                        <h5>Тип бизнеса</h5>
                                        <p>{{ result.business_type }}</p>
                                    </div>
                                </div>
                                
                                <div class="detail-item">
                                    <div class="detail-icon">
                                        <i class="fas fa-expand-arrows-alt"></i>
                                    </div>
                                    <div class="detail-content">
                                        <h5>Размер бизнеса</h5>
                                        <p>{{ result.business_size }}</p>
                                    </div>
                                </div>
                                
                                <div class="detail-item">
                                    <div class="detail-icon">
                                        <i class="fas fa-list-ul"></i>
                                    </div>
                                    <div class="detail-content">
                                        <h5>Выбранные функции</h5>
                                        {% if result.features %}
                                        <ul class="feature-list">
                                            {% for feature in result.features %}
                                            <li>{{ feature }}</li>
                                            {% endfor %}
                                        </ul>
                                        {% else %}
                                        <p>Дополнительные функции не выбраны</p>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="price-summary">
                                <div class="price-header">
                                    <h3>Итоговая стоимость</h3>
                                </div>
                                <div class="price-value animated-price">
                                    {{ result.price }} руб.
                                </div>
                                <div class="price-info">
                                    <p><i class="fas fa-info-circle me-2"></i>Полная стоимость запуска бизнес-проекта</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <hr>
                    
                    <div class="recommendations mt-4">
                        <h3 class="mb-3">Рекомендации</h3>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="recommendation-card">
                                    <div class="recommendation-icon">
                                        <i class="fas fa-rocket"></i>
                                    </div>
                                    <h5>Запуск</h5>
                                    <p>Оптимальный срок запуска: <strong>2-3 месяца</strong></p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="recommendation-card">
                                    <div class="recommendation-icon">
                                        <i class="fas fa-hand-holding-usd"></i>
                                    </div>
                                    <h5>Окупаемость</h5>
                                    <p>Ожидаемый срок окупаемости: <strong>12-18 месяцев</strong></p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="recommendation-card">
                                    <div class="recommendation-icon">
                                        <i class="fas fa-users"></i>
                                    </div>
                                    <h5>Персонал</h5>
                                    <p>Рекомендуемый штат: <strong>5-7 человек</strong></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-buttons mt-5 text-center">
                        <a href="{{ url_for('constructor') }}" class="btn btn-outline-primary btn-lg me-3">
                            <i class="fas fa-edit me-2"></i>Изменить параметры
                        </a>
                        <a href="#" class="btn btn-success btn-lg" id="downloadPdfBtn">
                            <i class="fas fa-file-pdf me-2"></i>Скачать бизнес-план
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="next-steps mt-4 text-center" data-aos="fade-up" data-aos-delay="100">
                <p class="mb-2">Нужна помощь в реализации вашего бизнес-плана?</p>
                <a href="{{ url_for('contact') }}" class="btn btn-outline-secondary">
                    <i class="fas fa-headset me-2"></i>Получить консультацию специалиста
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Анимация цены при загрузке страницы
    document.addEventListener('DOMContentLoaded', function() {
        const priceElement = document.querySelector('.animated-price');
        // Получаем числовое значение цены из текста, удаляя нечисловые символы
        const priceText = priceElement.textContent.trim();
        const finalPrice = parseInt(priceText.replace(/\D/g, ''));
        
        let startPrice = 0;
        const duration = 1500; // длительность анимации в мс
        const startTime = performance.now();
        
        function animatePrice(currentTime) {
            const elapsedTime = currentTime - startTime;
            const progress = Math.min(elapsedTime / duration, 1);
            
            // Функция плавности
            const easeOutQuad = t => t * (2 - t);
            const easedProgress = easeOutQuad(progress);
            
            const currentPrice = Math.floor(startPrice + (finalPrice - startPrice) * easedProgress);
            // Форматируем число с пробелами между разрядами (русский формат)
            priceElement.textContent = currentPrice.toLocaleString('ru-RU') + ' руб.';
            
            if (progress < 1) {
                requestAnimationFrame(animatePrice);
            }
        }
        
        requestAnimationFrame(animatePrice);
    });
    
    // Обработчик для кнопки скачивания PDF
    document.getElementById('downloadPdfBtn').addEventListener('click', function(e) {
        e.preventDefault();
        alert('Функция скачивания PDF будет доступна в ближайшее время!');
    });
</script>
{% endblock %} 